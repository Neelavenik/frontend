"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ec976ae1-2b61-5729-ae5b-6b03b000e39f")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[9082],{780634:(e,t,a)=>{a.d(t,{Do:()=>_,Du:()=>p,El:()=>h,JO:()=>b,Jx:()=>E,Lp:()=>I,Mc:()=>g,ON:()=>r,RW:()=>f,Rq:()=>s,Vr:()=>u,Vs:()=>C,Y:()=>l,YZ:()=>d,ZF:()=>k,h3:()=>y,hu:()=>m,jG:()=>c,kL:()=>n,qc:()=>i,qp:()=>v,se:()=>o,xn:()=>w});let n="post_to_feed_view--container--BiDZs",o="post_to_feed_view--noContentContainer--VE8Tm post_to_feed_view--container--BiDZs text--fontPos16--oMC-G text--_fontBase--QdLsd",l="post_to_feed_view--searchFilterContainer--lyX72",r="post_to_feed_view--searchBar--IwmvI",i="post_to_feed_view--searchIcon---WXsZ",s="post_to_feed_view--caretIcon--akCZQ",d="post_to_feed_view--pageMenuDropdown--bS4RV",c="post_to_feed_view--scrollContainer--syalR",m="post_to_feed_view--innerScrollContainer--aP8K2",_="post_to_feed_view--loadingSpinnerContainer--E8n20",f="post_to_feed_view--pageSection--85j7J",u="post_to_feed_view--pageHeader--ZOfTF",p="post_to_feed_view--pageHeaderFaint--p-zwO",g="post_to_feed_view--tilesGrid--Ft03l",C="post_to_feed_view--tile--9a4ta",h="post_to_feed_view--selectedTile--D6T9A post_to_feed_view--tile--9a4ta",y="post_to_feed_view--tileThumbnail--FkrR9",E="post_to_feed_view--tileOverlay--iyl2x",b="post_to_feed_view--tileDetails--FZrxQ",v="post_to_feed_view--nodeName--jbJro",w="post_to_feed_view--thumbnail--uAumv",I="post_to_feed_view--notFoundContainer--5cMl3 text--fontPos16--oMC-G text--_fontBase--QdLsd",k="post_to_feed_view--searchQuery--TIyhI"},470400:(e,t,a)=>{a.d(t,{CQ:()=>i,DA:()=>b,Ev:()=>x,Fd:()=>_,Hc:()=>o,JT:()=>N,KG:()=>v,OW:()=>F,RO:()=>g,Ru:()=>k,UD:()=>d,YI:()=>f,_5:()=>T,_f:()=>s,aF:()=>c,ku:()=>h,lt:()=>y,oW:()=>I,oj:()=>S,pb:()=>u,q3:()=>E,w8:()=>l,wg:()=>w,xe:()=>r,y3:()=>n,yD:()=>m,zE:()=>C,zb:()=>p});let n="create_feed_post_modal--avatarFloat--iIveN",o="create_feed_post_modal--modalHeader---WjMY permissions_modal--fileTitle--487xP",l="create_feed_post_modal--addBorder--ioWGk",r="create_feed_post_modal--contentContainerV2--QwkuY",i="create_feed_post_modal--buttonRowV3--5nAjk modal--buttonRow--o2A0S",s="create_feed_post_modal--buttonRowLeft--TRB9A",d="create_feed_post_modal--buttonContainer--eO4q8",c="create_feed_post_modal--inputSectionMinimized--bq7wz create_feed_post_modal--inputSection--7p1jN",m="create_feed_post_modal--inputFields--bFFV7",_="create_feed_post_modal--draftText--n3VG5",f="create_feed_post_modal--postLoadingSpinner--rky-A",u="create_feed_post_modal--postButton--kaBoj",p="create_feed_post_modal--postingButton--VH5JE create_feed_post_modal--postButton--kaBoj",g="create_feed_post_modal--modalWrapper--4Bi1n",C="create_feed_post_modal--modalWrapperMinimized--syjBM create_feed_post_modal--modalWrapper--4Bi1n",h="create_feed_post_modal--contentNonEmpty--vTrJ6",y="create_feed_post_modal--contentWrapperMinimizedV2--Y56bB create_feed_post_modal--contentWrapperV2--CuYTA",E="create_feed_post_modal--contentWrapperV3--bCplT create_feed_post_modal--contentWrapperV2--CuYTA",b="create_feed_post_modal--descriptionWrapperV3--KrwNd",v="create_feed_post_modal--avatarAndDescriptionWrapperMinimized--yrvzI create_feed_post_modal--avatarAndDescriptionWrapper--JTvU3",w="create_feed_post_modal--minimizedButtonContainerV2--ZJZV- create_feed_post_modal--minimizedButtonContainer--fxgaf",I="create_feed_post_modal--containerPicker--gOWkH",k="create_feed_post_modal--containerPickerTextDisabled--rvG3l",x="create_feed_post_modal--containerButtonDisabled--Qtxk7 create_feed_post_modal--containerButton--CgmgL",S="create_feed_post_modal--containerButtonInner--AiLpd",N="create_feed_post_modal--containerButtonText--99vNr",F="create_feed_post_modal--caret--dGHxv",T="create_feed_post_modal--loadingWrapper--mesOB"},290237:(e,t,a)=>{a.d(t,{X:()=>o});var n=a(547807);let o=new class{constructor(){this.GetDefaultContainerSchemaValidator=(0,n.vh)(),this.SetDefaultContainerSchemaValidator=(0,n.vh)()}getDefaultContainer(e){return this.GetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.get(`/api/feed_default_container/${e.orgId}`))}setDefaultContainer(e){return this.SetDefaultContainerSchemaValidator.validate(async({xr:t})=>await t.post("/api/feed_default_container",n.td.toAPIParameters(e)))}}},118143:(e,t,a)=>{a.r(t),a.d(t,{CreateFeedPostContent:()=>ef,CreateFeedPostModal:()=>e_,getUploadErrorMessage:()=>em});var n=a(411855),o=a(188507),l=a(629019),r=a.n(l),i=a(776250),s=a(935283),d=a(609494),c=a(358145),m=a(966712),_=a(374626),f=a(498750),u=a(860601),p=a(395900),g=a(743282),C=a(27087),h=a(448169),y=a(946689),E=a(493323),b=a(574176),v=a(762638),w=a(881388),I=a(939863),k=a(392592),x=a(67294),S=a(738269),N=a(507877),F=a(662275),T=a(694687),D=a(860178),M=a(99506),P=a(204279),O=a(531827),A=a(28588),B=a(103271),L=a(290237),R=a(320063),K=a(763223),W=a(456104),U=a(318812),z=a(309798),H=a(397065),$=a(340514),G=a(864114),Q=a(463546),V=a(919960);function Z(){let e=(0,W.e)({overlay:Q.K69,priority:H.N.DEFAULT_MODAL}),t=(0,U.BK)(V.lU),a=(0,K.w)(),o=!!(0,z.f)("has_seen_feed_audience_selection_overlay"),l=n.useMemo(()=>!o&&!!a&&!t.showing,[o,a,t.showing]);return(0,R.h)(()=>{l&&e.show()}),n.useEffect(()=>{t.showing&&e.complete()},[t.showing,e]),n.createElement($.rq,{isShowing:e.isShowing,zIndex:G.R.MODAL,targetKey:"feed-audience-container-selection-nux",trackingContextName:"Team feed first audience container selection",title:(0,I.tx)("rcs.feed_onboarding.audience_selection.title"),description:n.createElement("p",{"data-testid":"team-feed-first-time-post"},(0,I.tx)("rcs.feed_onboarding.audience_selection.content")),onClose:e.complete,userFlagOnShow:"has_seen_feed_audience_selection_overlay",emphasized:!0})}var q=a(49218),j=a(261076),X=a(126674),Y=a(679736),J=a(406158),ee=a(301799),et=a(583630),ea=a(660040),en=a(563288),eo=a(160156),el=a(339617),er=a(782680),ei=a(988898),es=a(470400),ed=a(112512);let ec=[Y.My.CONTEXT_MENU,Y.My.SHARE];function em(e){switch(e.type){case A.Wn.MAX_UPLOADS_EXCEEDED:return(0,I.t)("fig_feed.too_many_content_items",e.params);case A.Wn.MAX_VIDEO_SIZE_EXCEEDED:return(0,I.t)("fig_feed.video_file_size_limit_MB",e.params);case A.Wn.MAX_IMAGE_SIZE_EXCEEDED:return(0,I.t)("fig_feed.image_file_size_limit_MB",e.params);case A.Wn.INVALID_FILE_TYPE:return(0,I.t)("fig_feed.unsupported_file_types_were_not_uploaded");case A.Wn.DUPLICATE_FILE_UPLOAD:return(0,I.t)("fig_feed.already_uploaded_items",e.params);case A.Wn.FAILED_TO_UPLOAD:return(0,I.t)("fig_feed.error_on_feed_post_creation");default:(0,s.xb)(e)}}function e_(e){let t=(0,o.wA)(),a=(0,T.sZ)(),l=(0,j.R)(),r=n.useCallback(()=>{t(F.Ce())},[t]),i=(a?.name&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:a.name}))??(0,I.tx)("fig_feed.post_to_feed");return n.createElement(q.hZ,{header:n.createElement("div",{className:es.Hc},i),onClose:()=>l(r),maxWidth:q.Fo,disableFixedTop:!0,closeOnEsc:!0},n.createElement(ef,{nodeInfo:e.nodeInfo,uploadInfo:e.uploadInfo,prototypeInfo:e.prototypeInfo,pageBackgroundColor:e.pageBackgroundColor,onSubmitSuccess:e.onSubmitSuccess,entryPoint:e.entryPoint,lockedFileKey:e.lockedFileKey}))}function ef(e){let t=(0,o.wA)(),a=(0,T.sZ)(),l=(0,D.iZ)(),[s,R]=(0,_.fp)(j.T),[K,W]=n.useState(!1),[U,z]=n.useState(!0),[H,$]=n.useState(!1),[G,Q]=n.useState(!1),[e_,ef]=n.useState((0,I.t)("fig_feed.title_input_placeholder")),eu={id:a?.id??"",type:M.Gr.ORG,name:a?.name??"",isPrivate:!1},[ep,eg]=n.useState(eu),[eC,eh]=n.useState(eu);n.useEffect(()=>{a&&L.X.getDefaultContainer({orgId:a?.id}).then(({data:e})=>{if(e.meta){let t={id:e.meta.container_id,type:(0,en.Ti)(e.meta.container_type),name:e.meta.container_name,isPrivate:e.meta.is_private};eh(t),eg(t)}})},[a]);let[ey,eE]=n.useState(e.nodeInfo??null),eb=e.setMinimized,ev=n.useCallback(e=>{eb&&eb(e)},[eb]),ew=(0,o.d4)(e=>e.modalShown),[eI,ek]=n.useState((0,g.g)()),[ex,eS]=n.useState(0),eN=n.useCallback(()=>{eG(""),eV([]),ev(!0),$(!1),eA([]),ek((0,g.g)()),eS(0),eE(null)},[ev]),eF=n.useCallback(()=>{t((0,F.to)({type:er.h,data:{onConfirm:eN},showModalsBeneath:!0}))},[t,eN]),eT=()=>{ef(B.ZP[Math.floor(Math.random()*B.ZP.length)]())};n.useEffect(()=>{eT()},[]);let eD=e.pageBackgroundColor,eM=ey?.fileKey??e.prototypeInfo?.fileKey??"";n.useEffect(()=>{let t={entryPoint:e.entryPoint};eM&&(t.fileKey=eM),(0,i.sx)("Team Feed Create Post Modal Opened",t)},[e.entryPoint,eM]);let eP=n.useCallback((e,n)=>{if(n){t(F.Ce());return}let o={text:(0,I.t)("fig_feed.view_post"),action:()=>{t(N.V3({url:(0,X.Kc)(a.id,{uuid:e})}))}};t(k.F.enqueue({message:(0,I.t)("fig_feed.posted_to_org_feed",{orgName:a.name}),button:o})),t(F.Ce())},[t,a]),[eO,eA]=n.useState([]),eB=n.useMemo(()=>new Set(eO.map(e=>e.displayContentItem.type===B.cM.NODE?e.displayContentItem.nodeId:null).filter(e=>null!==e)),[eO]);n.useEffect(()=>{(0,ee.sr)(ey,eB,eA,a?.id,eD)},[ey,eB,eA,a?.id,eD]);let eL=n.useRef(null);n.useEffect(()=>{let t=e.prototypeInfo;if(!a?.id||!t||eL.current)return;let n=(0,J.WI)(t,a.id);eL.current=n.displayContentItem,eA(e=>[...e.filter(e=>e.displayContentItem.type!==B.cM.PROTOTYPE),n])},[a?.id,e.prototypeInfo]);let eR=n.useCallback(e=>{let t=(0,eo.K1)(eO[ex].displayContentItem);eS(e.findIndex(e=>(0,eo.K1)(e)===t));let a=[];e.forEach(e=>{let t=(0,eo.K1)(e),n=eO.find(e=>(0,eo.K1)(e.displayContentItem)===t);n?a.push(n):console.error("Expected to have a matchedPendingItem")}),eA(a)},[eO,ex]),eK=n.useCallback(e=>{eS(eO.findIndex(t=>(0,eo.K1)(t.displayContentItem)===e))},[eO]),{setContentPreview:eW,snapshotStates:eU}=(0,ee.eh)(eO,eA),{onSubmitSuccess:ez}=e,eH=n.useCallback((a,n)=>{C.Ay.post("/api/feed_posts",a).then(a=>{ec.includes(e.entryPoint)?eP(a.data.meta.public_uuid,n):(eN(),eT()),n&&t(k.F.enqueue({message:(0,I.t)("fig_feed.post_submission_pending")})),ez&&ez(n)}).catch(()=>{t(w.s.error((0,I.t)("fig_feed.error_on_feed_post_creation"))),z(!1)})},[t,eP,ez,eN,e.entryPoint]),[e$,eG]=n.useState(""),[eQ,eV]=n.useState([]),eZ=n.useMemo(()=>({library:new O.M8(a.id)}),[a]);n.useEffect(()=>{z(e$.trim().length>ea.Y||(0,d._Z)(eQ).length>ea.e||0===eO.length)},[e$,eQ,eO.length]),n.useEffect(()=>{let e=e$.trim().length>0||!(0,d.I)(eQ);W(e||eO.length>0),R(e)},[eQ,R,e$,eO.length]);let eq=e.lockedFileKey||ey?.fileKey,ej=async n=>{let o=new p.M4;if(o.start(),(0,i.sx)("team_feed_onsubmit",{currentOrgPresent:!!a,submitDisabled:U},{logFromProber:!0}),!a||U)return;n?.preventDefault(),z(!0);let l={description_meta:eQ,org_id:a.id};l.background_color=eD;let r=(0,d._Z)(eQ);l.content=await (0,J.pj)(t,eO,eM,e$),(0,i.sx)("team_feed_content_awaited",{payloadContent:JSON.stringify(l.content)},{logFromProber:!0});let s=l.content.some(e=>e.pending);l.uuid=eI,e$?l.title=e$:l.title=r.length>0?r.slice(0,40)+"\u2026":(0,I.t)("fig_feed.untitled_post"),ep.id&&ep.type&&(l.container_id=ep.id,l.container_type=(0,en.FD)(ep.type)),eq&&(l.attached_file_key=eq),eH(l,s),o.stop(),(0,i.sx)("team_feed_click_to_post_latency",{elapsedTimeMs:o.getElapsedTime()},{forwardToDatadog:!0}),(0,i.sx)("Team Feed New Post Submitted",{fileKey:eM,entryPoint:e.entryPoint,text:r,numContentItems:l.content.length,contentItemTypes:l.content.map(e=>e.type),containerId:l.container_id,containerType:l.container_type,isCurrentDefaultContainer:l.container_id===eC.id&&l.container_type===eC.type},{forwardToDatadog:!0})},eX=n.useCallback((e,n)=>{if(!a)return;let o=Array.from(e);if(0===o.length)return;let l=(0,P.KT)(o,eO.length,B.e3,B.bB,e=>{t(k.F.enqueue({message:em(e)}))},eO.map(e=>e.fileIdentifier)).map(e=>{let t=(0,P.Fn)(e);if(A.xp.includes(e.type))return(0,J.zr)(t,e);if(A.VY.includes(e.type))return(0,J.X2)(t,eI,a.id,e);throw Error("unexpected file type")}),r=void 0!==n?n:eO.length;eA(e=>[...e.slice(0,r),...l,...e.slice(r)]),eS(r)},[t,a,eI,eO]),eY=n.useCallback((e,t)=>()=>{let a=e.current?.files||null;null!==a&&0!==a.length&&(eX(a,t),ev(!1),e.current&&(e.current.value=""))},[eX,ev]),eJ=(0,c.ZC)(e.uploadInfo);n.useEffect(()=>{e.uploadInfo&&e.uploadInfo!==eJ&&(ev(!1),eX(e.uploadInfo))},[e.uploadInfo,eJ,ev,eX]);let e0=n.useCallback(e=>{let t=Math.min(e,Math.max(0,eO.length-2)),a=eO[e];if((0,J.AK)(a),eA(t=>t.filter((t,a)=>a!==e)),a.displayContentItem.type===B.cM.NODE){let e=a.displayContentItem.nodeId;eE(t=>{if(t){let a=t.nodeIds.filter(t=>t!==e),n=t.nodeThumbnails,o=n&&a.reduce((e,t)=>(e[t]=n[t],e),{});return{...t,nodeIds:a,nodeThumbnails:o}}return null})}eS(t)},[eO]),e1=n.useCallback((e,t)=>{eX(e.files,t),Q(!1)},[eX]),e6=n.useRef(null),e3=!!ey?.nodeIds?.length,{openPostFromFileModal:e8,attachedFileData:e2}=(0,ee.Ld)({setLinkedFileNodeInfo:eE,numUserContentItems:eO.length,hasNodeContent:e3,parentModalRef:e6,attachedFileKey:eq,lockedFileKey:e.lockedFileKey,currentOrgId:a?.id}),e7=n.useCallback(()=>{let e=eO.map(e=>e.displayContentItem);return n.createElement(h.Y,{className:r()(es.xe,G&&es.w8),isDragTarget:()=>!0,onTargetDragEnter:()=>Q(!0),onTargetDragLeave:()=>Q(!1),onTargetDrop:e=>e1(e)},n.createElement(eo.Zo,{contentItems:e,staticContent:!0,scrollable:!1,deleteItemAtIdx:H?void 0:e0,pageBackgroundColor:eD,onReorderCallback:H?void 0:eR,shouldScrollToIndex:null,selectedIdx:ex,setSelectedIdx:eS,onFileInputChange:eY,setSelectedContent:eK,snapshotStates:eU,setContentPreview:eW,openPostFromFileModal:e8,attachedFile:e2,dragging:G,mode:"create"}))},[eD,G,eR,e0,H,eO,e1,ex,eY,eK,eU,eW,e8,e2]),e9=n.useCallback(e=>{e.keyCode===f.Uz.ESCAPE&&ev(!0)},[ev]),e4=n.useCallback(()=>{ew||(K&&(eG(e=>e.trim()),(0,d.I)(eQ)&&eV([])),ev(!0))},[eQ,ev,ew,K]),e5=n.useCallback(()=>{e4(),t(F.Ce())},[t,e4]),te=n.createElement("div",{className:r()(es.zE,s&&es.ku),onKeyDown:e.disabled?u.lQ:e9,role:"textbox",tabIndex:0,onClick:()=>!e.disabled&&ev(!1)},l&&n.createElement("div",{className:es.y3},n.createElement(el.A,{user:l,size:x.Pf.LARGE})),n.createElement("div",{className:es.lt},n.createElement("div",{className:es.KG},n.createElement("div",{className:es.aF},n.createElement("div",{className:es.yD},e$||e_," ",e$&&n.createElement("span",{className:es.Fd},(0,I.t)("fig_feed.draft")))),n.createElement("div",{className:es.wg},n.createElement(y.$$,{disabled:!0,dataTestId:"feed-post-post"},(0,I.tx)("fig_feed.post")))))),tt=n.createElement("div",{className:es.RO,onKeyDown:e9,role:"textbox",tabIndex:0,onClick:()=>ev(!1),ref:e6},n.createElement("div",{className:es.q3},e7(),a&&l?n.createElement("div",{className:es.DA},n.createElement(et.FeedPostUnifiedComposer,{user:l,currentOrgId:a.id,autofocus:!0,mentionables:eZ,onSubmit:U?void 0:ej,submitOnEnter:!1,hideSubmitButton:!0,description:eQ,updateDescription:eV,title:e$,updateTitle:eG,displayDecoratorsDownwards:!0,minimized:e.minimized,readOnly:H,editableTypeaheadClass:ei.up,openPostFromFileModal:()=>e8({skipFrameSelection:!e3}),fileData:e2,lockFileAddition:eO.length>=B.e3,parentRef:e6,canUnlinkFile:!e3&&!e.lockedFileKey,unlinkFile:()=>eE(null)})):null),n.createElement("div",{className:es.CQ},n.createElement("div",{className:es._f},n.createElement("div",{className:v.cx.flex.itemsCenter.$},(0,I.tx)("fig_feed.post_to"),n.createElement(V.zr,{dropdownId:V.lU,orgId:a.id,defaultContainer:eC,selectedContainer:ep,onContainerSelect:e=>{eg(e),t(S.oB())},onSetDefaultContainer:eh,hideAllSpaces:!0,showMemberCount:!0,showUnusedContainers:!0},n.createElement("div",{className:v.cx.flex.justifyCenter.itemsCenter.ml8.pr4.pl8.h32.maxW300.borderBox.bRadius5.colorBorder.b1.bSolid.overflowHidden.selectNone.$,"data-onboarding-key":"feed-audience-container-selection-nux"},n.createElement(V.xM,{option:ep,defaultContainer:eC,showMemberCount:!1}),n.createElement("div",{className:es.OW},n.createElement(b.B,{svg:ed.A})))),n.createElement(Z,null))),n.createElement("div",{className:es.UD},!ec.includes(e.entryPoint)&&(K?n.createElement(y.nR,{onClick:e=>{e.stopPropagation(),eF()}},(0,I.tx)("fig_feed.discard_draft")):n.createElement(y.nR,{onClick:e=>{e.stopPropagation(),eN()}},(0,I.tx)("general.cancel"))),n.createElement(y.$$,{onClick:e=>{if(!H)return $(!0),ej(e).finally(()=>{$(!1)})},disabled:U,dataTestId:"feed-post-post",className:H?es.zb:es.pb},H&&n.createElement("div",{className:es.YI},n.createElement(E.kt,{shouldMatchTextColor:!0,size:"medium"})),H?(0,I.tx)("fig_feed.posting"):(0,I.tx)("fig_feed.post"))))),ta=(a?.name&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:a.name}))??(0,I.tx)("fig_feed.post_to_feed");return a&&l&&(0,m.kc)().xr_debounce_threshold?e.entryPoint===Y.My.FEED_HEADER?n.createElement(n.Fragment,null,te,!e.minimized&&n.createElement(q.hZ,{header:n.createElement("div",{className:es.Hc},ta),onClose:e5,maxWidth:q.Fo,disableFixedTop:!0},tt)):tt:null}},301799:(e,t,a)=>{a.d(t,{sr:()=>z,eh:()=>$,Ld:()=>H});var n=a(411855),o=a(109388),l=a(188507),r=a(539321),i=a(939863),s=a(392592),d=a(662275),c=a(421123),m=a(691205),_=a(103271),f=a(406158),u=a(160156),p=a(629019),g=a.n(p),C=a(935283),h=a(540193),y=a(823810),E=a(391388),b=a(860601),v=a(768137),w=a(493323),I=a(827586),k=a(205054),x=a(860178),S=a(498606),N=a(237870),F=a(761939),T=a(706638),D=a(227795),M=a(585878);let P="post_from_file_modal--grid--JdmAi",O="post_from_file_modal--searchLoadingSpinnerContainer---qSgU post_from_file_modal--loadingSpinnerContainer--QaXkG";var A=a(647173);let B=`https://${window.location.host}`;var L=(e=>(e[e.SELECT_FILE=1]="SELECT_FILE",e[e.SELECT_NODE=2]="SELECT_NODE",e))(L||{});function R(e){let t=n.useRef(null),a=(0,x.TA)(),o=encodeURIComponent(`${e.selectedFile.url}?fuid=${a}&post-to-feed=1&force-incremental=0`),l=`${B}/embed?integration_host=fig-feed&url=${o}`,[r,s]=n.useState(!1),[d,c]=n.useState([]);n.useEffect(()=>{let e=e=>{if(window.parent.origin!==e.origin)return;let{type:t,data:a}=e.data;t===T.v.LOADED&&s(()=>!0),t===T.v.SELECT_NODE&&c(()=>a??[])};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let m=d.length>0;return n.createElement(n.Fragment,null,!r&&n.createElement("div",{className:"post_from_file_modal--embedLoadingSpinnerContainer--x0E-V post_from_file_modal--loadingSpinnerContainer--QaXkG"},n.createElement(w.kt,{size:"large"})),n.createElement("iframe",{ref:t,className:"post_from_file_modal--iframe--W8QSR",title:"Figma",src:l,scrolling:"no"}),n.createElement("div",{className:"post_from_file_modal--footer--UhneR"},n.createElement(v.$$,{onClick:t=>{t.stopPropagation(),e.setNodeInfo({fileKey:e.selectedFile.key,nodeIds:d.map(e=>e.guid),nodeThumbnails:d.reduce((e,{guid:t,thumbnail:a})=>{let n=new Blob([a]),o=URL.createObjectURL(n);return{...e,[t]:o}},{}),backgroundColorByNode:d.reduce((e,{guid:t,backgroundColor:a})=>a?{...e,[t]:a}:e,{})}),e.hideModal?.()},disabled:!m},(0,i.tx)("fig_feed.add_to_post"))))}function K(e){let t=(0,h.ql)(e.orgId),a=E.Qw.useTransformShallowEqual(t,e=>e.filter(e=>e.can_edit)),o="loaded"===a.status,{setSelectedFile:l,onAfterSelect:r}=e,s=n.useCallback(e=>{l(e),r()},[l,r]),[d,c]=n.useState(""),[m,_]=n.useState(null),f=n.useMemo(()=>m?.map(e=>e.model.key)??[],[m]),u=(0,y.IT)(f),p=n.useMemo(()=>null===m?null:"loaded"===u.status?m.filter(e=>u.data[e.model.key]?.canEdit):null,[u,m]),g=n.useCallback(e=>n.createElement("div",{className:"post_from_file_modal--tileContainer--f1mpx",onClick:()=>{s(e)},role:"button",tabIndex:0,key:`tile-${e.key}`},n.createElement("div",{className:"post_from_file_modal--chooseFile--3ABxf"},(0,i.t)("fig_feed.choose_file")),n.createElement(k.GQ,{file:e,currentUser:null,activeFileUsers:[],subtitle:n.createElement(k.lJ,{file:e}),onClick:b.lQ})),[s]),C=n.useMemo(()=>d?p?0===p.length?n.createElement("div",{className:"post_from_file_modal--notFoundContainer--JLJWT text--fontPos16--oMC-G text--_fontBase--QdLsd"},n.createElement("div",null,(0,i.tx)("community.universal_posting_modal.recent_editable_files_search.no_files_matching",{searchQuery:n.createElement(n.Fragment,null,n.createElement("span",{className:"post_from_file_modal--searchQuery--GpUQJ"},d))}))):n.createElement(I.P,{hideScrollbar:!0},n.createElement("div",{className:P},p.map(e=>g(e.model)))):n.createElement("div",{className:O},n.createElement(w.kt,{size:"large"})):a.data&&n.createElement(I.P,{hideScrollbar:!0},n.createElement("div",{className:P},a.data.map(e=>g(e)))),[a.data,p,d,g]);return o?n.createElement(n.Fragment,null,n.createElement("div",{className:"post_from_file_modal--searchContainer--oiMYX"},n.createElement(F.IW,{query:d,setQuery:c,setSearchResults:_,placeholderText:(0,i.t)("fig_feed.search_files")})),C):n.createElement("div",{className:O},n.createElement(w.kt,{size:"large"}))}function W(e){let{setModalPage:t,orgId:a,setSelectedFile:o}=e;return n.createElement(K,{orgId:a,setSelectedFile:o,onAfterSelect:e.skipFrameSelection?e.hideModal:()=>{t?.(2)}})}let U=(0,N.Ju)(function(e){let t=(0,l.wA)(),a=()=>{t(d.Lo()),e.parentRef?.current?.focus()},[o,r]=n.useState(e.attachedFile),[s,c]=n.useState(e.lockFileSelection||e.attachedFile?2:1),{setFeedPostNodeInfo:m}=e,_=n.useCallback(e=>{r(e),m({fileKey:e.key,nodeIds:[]})},[m]),f=e=>c(()=>e);return n.createElement(M.XV,{title:(()=>{switch(s){case 1:return(0,i.t)("fig_feed.choose_a_file");case 2:return n.createElement("div",{className:g()("post_from_file_modal--leftButtonGroup--ZT4p5",e.lockFileSelection&&"post_from_file_modal--headerPadding--6G68d")},!e.lockFileSelection&&n.createElement(D.K0,{svg:A.A,onClick:()=>f(1),"data-tooltip":(0,i.t)("fig_feed.button.back"),"data-tooltip-type":S.Ib.TEXT})," ",o?.name??"");default:(0,C.xb)(s)}})(),onClose:a,containerClassName:"post_from_file_modal--modalView--qMQ2p",innerContainerClassName:"post_from_file_modal--innerModalView--CfMj1",disableClickOutsideToHide:!0,maxWidth:1===s?1024:680,closeOnEsc:!0},(()=>{switch(s){case 1:return n.createElement(W,{orgId:e.orgId,setModalPage:f,setSelectedFile:_,hideModal:a,skipFrameSelection:e.skipFrameSelection});case 2:if(!o)return null;return n.createElement(R,{selectedFile:o,hideModal:a,setNodeInfo:e.setFeedPostNodeInfo});default:(0,C.xb)(s)}})())},"PostFromFileModal");function z(e,t,a,n,l){if(!n||!e)return;let r=e.nodeIds.filter(e=>!t.has(e));0!==r.length&&(queueMicrotask(()=>{(0,o.flushSync)(()=>{a(t=>[...t,...(0,f.Px)(e.fileKey,r,n)])})}),(0,f.Rl)(e.fileKey,r,n,l,e.nodeThumbnails,e.backgroundColorByNode).then(e=>{a(t=>t.map(t=>t.displayContentItem.type===_.cM.NODE&&t.displayContentItem.isLoading?e[t.displayContentItem.nodeId]:t))}))}function H(e){let{setLinkedFileNodeInfo:t,numUserContentItems:a,hasNodeContent:o,parentModalRef:r,attachedFileKey:c,lockedFileKey:f,currentOrgId:u}=e,p=(0,l.wA)(),g=m.M4.useFile(c).data,C=n.useCallback(e=>{if(!f||e.fileKey===f){if(e.nodeIds.length+a>_.e3){p(s.F.enqueue({message:(0,i.t)("fig_feed.too_many_content_items",{maxNum:_.e3})}));return}t(t=>{let a=e.nodeIds,n=e.nodeThumbnails,o=e.backgroundColorByNode;return t&&e.fileKey===t.fileKey?{fileKey:t.fileKey,nodeIds:[...new Set(t.nodeIds.concat(a))],nodeThumbnails:{...t.nodeThumbnails,...n},backgroundColorByNode:{...t.backgroundColorByNode,...o}}:{fileKey:e.fileKey,nodeIds:a,nodeThumbnails:n,backgroundColorByNode:o}})}},[p,a,f,t]);return{openPostFromFileModal:n.useCallback(e=>{u&&p((0,d.to)({type:U,data:{orgId:u,setFeedPostNodeInfo:C,attachedFile:g,parentRef:r,lockFileSelection:f||g&&o,skipFrameSelection:e?.skipFrameSelection}}))},[p,u,C,g,f,o,r]),attachedFileData:g}}function $(e,t){return{setContentPreview:n.useCallback((a,n,o)=>{let l=Array.from(e),i=l.findIndex(e=>(0,u.K1)(e.displayContentItem)===a),s=l[i];if(s&&(0,_.aT)(s.displayContentItem)){s.preview={url:n,state:o};let e=s.displayContentItem;e.preview_image_url=n,e.backgroundColor=(0,r.colorToHex)(o.backgroundColor),t(l)}else console.error("expected to find matched content item")},[e,t]),snapshotStates:n.useMemo(()=>e.reduce((e,t)=>(t.preview?e[(0,u.K1)(t.displayContentItem)]=t.preview.state:(0,f.EU)(t.displayContentItem)&&(e[(0,u.K1)(t.displayContentItem)]={x:t.displayContentItem.initialX,y:t.displayContentItem.initialY,zoom:t.displayContentItem.initialZoom,ratio:1,backgroundColor:(0,c.dy)(t.displayContentItem.backgroundColor)}),e),{}),[e])}}},919960:(e,t,a)=>{a.d(t,{zr:()=>Z,xM:()=>V,lU:()=>z,Qn:()=>j});var n=a(411855),o=a(188507),l=a(629019),r=a.n(l),i=a(776250),s=a(297666),d=a(320063);if(443==a.j)var c=a(860601);var m=a(547807),_=a(572206),f=a(268537),u=a(659838),p=a(493323),g=a(827586),C=a(32863),h=a(574176),y=a(24973);function E(e){let{tabs:t,selectedTabKey:a,onTabClick:o}=e;return n.createElement("div",{className:y.vR},t.map(e=>n.createElement("button",{key:e.key,className:e.key===a?y.xR:y.Mf,onClick:()=>o(e.key)},e.label)))}var b=a(762638),v=a(939863),w=a(392592),I=a(738269),k=a(767518);class x{constructor(e,t={list:k.U.getFeedPostCreators,search:k.U.searchFeedPostCreators}){this.api=t,this.orgId=e}async list(){try{let{data:{meta:e}}=await this.api.list({orgId:this.orgId});return e}catch(e){console.error("An error ocurred while trying to fetch feed post creator contacts.",e)}return[]}async search(e){try{let{data:{meta:t}}=await this.api.search({query:e,orgId:this.orgId});return t}catch(e){console.error("An error ocurred while searching for feed post creator contacts.",e)}return[]}maxResultsLength(){return 100}}var S=a(860178),N=a(103271),F=a(498606),T=a(290237),D=a(260262),M=a(720488),P=a(746806),O=a(563288);let A="feed_list_filters--dropdownOption--L2vCH feed_list_filters--dropdownOptionBase--S-hRH",B="feed_list_filters--containerOptionContentText--D4-Oc";if(443==a.j)var L=a(112512);var R=a(639685),K=a(524289),W=a(630834);let U="feed-user-filter-dropdown",z="feed-container-creation-dropdown";var H=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LIGHT=1]="LIGHT",e))(H||{});function $(){return n.createElement("div",{className:"feed_list_filters--dropdownSeparator--5CG0F"})}function G(e){let{setSelectedOption:t}=e,a=n.useRef(null),o=n.useRef(""),[l,r]=n.useState(""),[i,d]=n.useState([]),[c,m]=n.useState(!1),{search:y}=e,E=n.useCallback(async e=>{try{m(!0);let t=await y(e);d(t)}catch(e){console.error(e)}finally{m(!1)}},[y]);n.useEffect(()=>{l&&o.current!==l&&E(l),o.current=l},[l,E]);let b=(0,s.s)(r,250),w=n.useCallback(()=>r(""),[]),I=n.useCallback(e=>{b(e)},[b]),{searchInputRef:k,onMouseDown:x,onMouseUp:S,onBlur:N,onSearchChange:F,onSearchKeyDown:T,onClearSearchClick:O,onClearSearchKeyDown:B}=(0,C.ne)({query:l,focusOnMount:!1,clearSearch:w,onChange:I},a),L=n.useCallback(e=>{"Enter"===e.key&&B(e),e.stopPropagation()},[B]),K=n.useCallback(e=>()=>{t(e)},[t]);return n.createElement(D.N,{dropdownId:e.dropdownId,renderDropdown:t=>{let a=n.createElement("div",{className:"feed_list_filters--searchBar--SmGQW",key:"search-bar"},n.createElement(h.B,{className:"feed_list_filters--searchIcon--uk2jc",svg:R.A}),n.createElement(u.L,{className:"feed_list_filters--searchInput--fYyKR",ref:k,placeholder:e.searchPlaceholder,value:l,onChange:F,onKeyDown:T,onMouseDown:x,onMouseUp:S,onBlur:N,style:{width:"100%"},autoFocus:!0}),!!l&&n.createElement("button",{className:"feed_list_filters--closeButton--57DHM",onClick:O,onKeyDown:L},n.createElement(h.B,{svg:W.default}))),o=l?i:e.initialOptions,r=(t,a,o,l)=>{switch(t.optionType){case"no_matching_results":return n.createElement("div",{key:"no-matching-results",className:"feed_list_filters--dropdownOptionNoMatchingResults--QuGf9 feed_list_filters--dropdownOptionBase--S-hRH"},(0,v.tx)("fig_feed.no_matching_results"));case"group":let i=`${a}-group`;return n.createElement(n.Fragment,{key:`${a}-frag`},t.label&&n.createElement("div",{className:"feed_list_filters--dropdownGroupHeader--GzXg- feed_list_filters--dropdownOptionBase--S-hRH"},t.label),t.options.map((e,t)=>r(e,t,i)),!l&&n.createElement($,null));case"option":return n.createElement(f.MM,{key:`${a}-${t.id}${o?`-${o}`:""}`,className:A,onClick:K(t),checked:e.selectedOption===t.id},t.display)}},s=n.createElement(g.P,{maxHeight:e.maxContentHeight,hideScrollbar:!0},e.defaultDisplay&&n.createElement(n.Fragment,null,n.createElement(f.MM,{className:A,onClick:K(null),checked:null===e.selectedOption},e.defaultDisplay),n.createElement($,null)),c?n.createElement("div",{className:"feed_list_filters--loadingSpinner--Pe67Z"},n.createElement(p.kt,{size:"small"})):o.map((e,t)=>r(e,t,void 0,t===o.length-1))),d=n.createElement(n.Fragment,null,a,n.createElement($,{key:"initial-separator"}),s);return 1===e.type?n.createElement(P.vx,{title:"",headerSize:"hidden",initialConstraints:{x:"left",y:"bottom"},initialPosition:new _.Mi(t.x,window.innerHeight-t.bottom),initialWidth:300,maxWidth:300,dragHeaderOnly:!1,containerClassName:"feed_list_filters--dropdownModalContainer--17bB-",frameStyle:{borderRadius:"4px"},disableDragging:!0},n.createElement("div",{className:"feed_list_filters--lightDropdown--mlEQW"},d)):n.createElement(M.Cf,{showPoint:!0,targetRect:t,lean:"left",minWidth:300,maxWidth:300,disableDropdownScrollContainer:!0,propagateCloseClick:!0},n.createElement("div",{className:"feed_list_filters--defaultDropdown--723ga"},d))},hideOverflow:!0},e.children)}let Q=(0,m.vh)();function V(e){let t=e.defaultContainer&&e.option.id===e.defaultContainer.id&&e.option.type===e.defaultContainer.type,a=e.defaultContainer&&!t&&e.setDefaultContainer,o=e.showSecretTeamTooltip&&e.option.isPrivate?(0,v.t)("fig_feed.secret_team_tooltip",{containerName:e.option.name}):void 0;return n.createElement("div",{className:"feed_list_filters--containerOptionWrapper--4u6Op"},n.createElement("div",{className:"feed_list_filters--containerOptionContent--QdBnH","data-tooltip-type":F.Ib.TEXT,"data-tooltip":o},n.createElement(O.lO,{containerInfo:{type:e.option.type},withoutTooltip:!0}),n.createElement("div",{className:"feed_list_filters--containerOptionContentInner--LFrFD"},n.createElement("div",{className:B},e.option.name),e.option.isPrivate&&n.createElement(h.B,{className:"feed_list_filters--containerPrivateIcon--4xKbs",svg:K.A}),t&&n.createElement("div",{className:"feed_list_filters--defaultLabel--cbaPB"},(0,v.tx)("fig_feed.default_in_parens")))),e.showMemberCount&&null!=e.option.memberCount&&n.createElement("div",{className:r()("feed_list_filters--containerMemberCountWrapper--0me3F")},n.createElement("div",{className:r()("feed_list_filters--containerMemberCount--it5uh",{"feed_list_filters--hideOnHover--W-LgR":a})},(0,v.tx)("fig_feed.num_members",{numMembers:e.option.memberCount??0})),a&&n.createElement("div",{className:"feed_list_filters--setDefaultContainer--Fjrjh",onMouseDown:t=>{t.stopPropagation(),e.setDefaultContainer?.(e.option)},role:"button",tabIndex:0},(0,v.tx)("fig_feed.set_as_default"))))}function Z(e){let t=(0,o.wA)(),[a,l]=n.useState(e.selectedContainer?[{...e.selectedContainer,optionType:"option",display:e.selectedContainer.name??""}]:[]),{onContainerSelect:r,onSetDefaultContainer:s}=e,c=(0,S.iZ)(),m=n.useCallback(a=>{(a.id!==e.defaultContainer?.id||a.type!==e.defaultContainer?.type)&&((0,i.sx)("Team Feed Set Default Audience",{containerId:a.id,containerType:a.type,userId:c?.id,orgId:e.orgId}),T.X.setDefaultContainer({containerId:a.id,containerType:(0,O.FD)(a.type),orgId:e.orgId}).then(()=>{r(a),s(a),t(w.F.enqueue({message:(0,v.t)("fig_feed.new_default_container_has_been_set")}))}))},[t,e.orgId,r,s,c?.id,e.defaultContainer]),_=n.useCallback(async t=>{let a=`/api/feed_posts/${e.orgId}/containers`,o=new URLSearchParams;t&&o.append("query",t),e.showMemberCount&&o.append("with_member_count","true"),e.showUnusedContainers&&o.append("with_unused_containers","true");let l=`${a}?${o.toString()}`;try{let a=await Q.validate(async({xr:e})=>await e.get(l)).then(e=>e.data.meta),o=t=>{let a=(0,O.Ti)(t.container_type),o={id:t.container_id,type:a,name:t.display_name,isPrivate:t.is_private,memberCount:t.member_count};return{optionType:"option",...o,display:n.createElement(V,{option:o,defaultContainer:e.defaultContainer,showMemberCount:e.showMemberCount,setDefaultContainer:m})}},r=(e,t)=>({optionType:"group",label:t,options:e.map(o)}),i=e.selectedContainer&&e.selectedContainer.id&&e.selectedContainer.type&&a.member_results.concat(a.results).some(t=>t.container_id===e.selectedContainer.id&&(0,O.Ti)(t.container_type)===e.selectedContainer.type),s=[];return!i&&e.selectedContainer&&s.push(r([{container_id:e.selectedContainer.id,container_type:(0,O.FD)(e.selectedContainer.type),display_name:e.selectedContainer.name,is_private:e.selectedContainer.isPrivate}],null)),0===a.member_results.length&&0===a.results.length?s.push({optionType:"no_matching_results"}):(a.member_results.length>0&&s.push(r(a.member_results,t?(0,v.t)("fig_feed.your_spaces"):(0,v.t)("fig_feed.your_recent_spaces"))),a.results.length>0&&s.push(r(a.results,t?(0,v.t)("fig_feed.other_spaces"):(0,v.t)("fig_feed.other_recent_spaces")))),s}catch(e){console.error(e)}return[]},[e.orgId,e.showMemberCount,e.showUnusedContainers,e.selectedContainer,e.defaultContainer,m]);(0,d.h)(()=>{_(null).then(e=>l(e))});let f=0;return e.dropdownId===z&&(f=1),n.createElement(G,{dropdownId:e.dropdownId,search:_,searchPlaceholder:(0,v.t)("fig_feed.placeholder.container_search"),defaultDisplay:e.hideAllSpaces?void 0:(0,v.t)("fig_feed.all_spaces"),initialOptions:a,selectedOption:e.selectedContainer?.id??null,setSelectedOption:t=>{e.onContainerSelect(t)},type:f,maxContentHeight:344},e.children)}function q(e){let[t,a]=n.useState([]),o=n.useMemo(()=>new x(e.orgId),[e.orgId]),l=e=>e.map(e=>({optionType:"option",id:e.id,display:n.createElement("div",{className:B},e.handle),handle:e.handle}));n.useEffect(()=>{o.list().then(e=>a(l(e.slice(0,o.maxResultsLength()))))},[o]);let r=async e=>{let t=await o.search(e);return 0===t.length?[{optionType:"no_matching_results"}]:l(t)};return n.createElement(G,{dropdownId:U,search:r,searchPlaceholder:(0,v.t)("fig_feed.placeholder.user_search"),defaultDisplay:(0,v.t)("fig_feed.all_users"),initialOptions:t,type:0,selectedOption:e.selectedUser?.id??null,setSelectedOption:t=>e.onUserSelect(t),maxContentHeight:344},e.children)}function j(e){let t=(0,o.wA)(),{setSelectedContainer:a,setSelectedUser:l}=e,r=n.useCallback(e=>{l(e)},[l]),i=e.selectedContainer?e.selectedContainer.name:(0,v.t)("fig_feed.all_spaces").toLocaleLowerCase(),s=e.selectedUser?e.selectedUser.handle:(0,v.t)("fig_feed.all_users").toLocaleLowerCase(),d=e=>n.createElement("div",{className:b.cx.flex.selectNone.overflowHidden.$},n.createElement("span",{className:b.cx.overflowHidden.ellipsis.noWrap.flexShrink1.$},e),n.createElement("div",{className:b.cx.flex.itemsCenter.justifyCenter.w16.colorIcon.$},n.createElement(h.B,{svg:L.A})));return n.createElement(n.Fragment,null,n.createElement("div",{className:b.cx.flex.itemsCenter.justifyBetween.mr8.h64.$},n.createElement("div",{className:b.cx.py12.pr8.$},n.createElement(E,{tabs:e.tabs,selectedTabKey:e.selectedTabKey,onTabClick:t=>{e.setSelectedTabKey(t)}})),e.selectedTabKey===N.S8.All&&n.createElement("div",{className:b.cx.flex.gap16.$},n.createElement("div",{className:b.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},n.createElement("label",{id:"feed-space-dropdown-label"},(0,v.tx)("fig_feed.label.in")),n.createElement(Z,{dropdownId:"feed-container-filter-dropdown",orgId:e.orgId,selectedContainer:e.selectedContainer,onContainerSelect:e=>{a(e),t(I.oB())},defaultContainer:null,onSetDefaultContainer:c.lQ,showMemberCount:!1},d(i))),n.createElement("div",{className:b.cx.flex.itemsCenter.gap4.maxW150.overflowHidden.$},n.createElement("label",{id:"feed-space-dropdown-label"},(0,v.tx)("fig_feed.label.by")),n.createElement(q,{dropdownId:U,orgId:e.orgId,selectedUser:e.selectedUser,onUserSelect:r},d(s))))))}}}]);

//# debugId=ec976ae1-2b61-5729-ae5b-6b03b000e39f

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/42750b2ce644ee68275dc284bb3458fbf451f5d1/9082-3c84b71ef592ed46.min.js.map